(function(a){a.fn.ligerTLEdit=function(b){return a.ligerui.run.call(this,"ligerTLEdit",arguments)};a.fn.ligerGetTLEditManager=function(){return a.ligerui.run.call(this,"ligerGetTLEditManager",arguments)};a.ligerDefaults.TLEdit={valueFieldID:null,css:null,nullText:null,disabled:false,cancelable:true,width:200,heigth:null,textField:"text",readonly:false};a.ligerMethos.TLEdit=a.ligerMethos.TLEdit||{};a.ligerui.controls.TLEdit=function(c,b){a.ligerui.controls.TLEdit.base.constructor.call(this,c,b)};a.ligerui.controls.TLEdit.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"TLEdit"},_extendMethods:function(){return a.ligerMethos.TLEdit},_init:function(){a.ligerui.controls.TLEdit.base._init.call(this)},_render:function(){a.ligerui.controls.TLEdit.base._render.call(this);var b=this,c=this.options;b.inputText=null;if(this.element.tagName.toLowerCase()=="input"){this.element.readOnly=true;b.inputText=a(this.element);b.textFieldID=this.element.id}if(b.inputText[0].name==undefined||b.inputText[0].name=="undefined"){b.inputText[0].name=b.textFieldID}b.valueField=null;b.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>');b.wrapper=b.inputText.wrap('<div class="l-text l-text-tl"></div>').parent();b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');b.wrapper.append(b.link);b.inputText.addClass("l-text-field");b.link.hover(function(){if(c.disabled){return}this.className="l-trigger-hover"},function(){if(c.disabled){return}this.className="l-trigger"}).mousedown(function(){if(c.disabled){return}this.className="l-trigger-pressed"}).mouseup(function(){if(c.disabled){return}this.className="l-trigger-hover"}).click(function(){if(c.disabled){return}var f,e,d;if(c.host_form){d=c.id,f=c.host_form.getData()}else{if(c.host_grid){d=c.host_grid_column.name,f=c.host_grid_row}}e=(f.__tls||{})[d]||{};if(b.getValue()){e[_locale]=b.getValue()}a.ligerDialog.open({height:300,width:500,title:c.title||$l("msg.info.multilanguage_editor")||"输入多语言信息",url:_basePath+"/sys/sys_multilanguage_editor.html?id="+(f[c.idField]||"")+"&dto="+c.dto+"&field="+d,data:e,buttons:[{text:$l("sys.hand.btn.ok"),onclick:function(i,g){var h=g.frame.tl_form;if(h.valid()){if(c.callback){c.callback(h.getData())}else{var j=h.getData(),k=f.__tls;if(!k){k={};f.__tls=k}b.setValue(j[_locale]);k[d]=j;if(f.__status=="nochanged"){f.__status="update"}}g.close()}}},{text:$l("sys.hand.btn.cancel"),onclick:function(h,g){g.close()}}]})});b.inputText.click(function(){if(c.disabled){return}}).blur(function(){if(c.disabled){return}b.wrapper.removeClass("l-text-focus")}).focus(function(){if(c.disabled){return}b.wrapper.addClass("l-text-focus")});b.wrapper.hover(function(){if(c.disabled){return}b.wrapper.addClass("l-text-over")},function(){if(c.disabled){return}b.wrapper.removeClass("l-text-over")});b.set(c)},destroy:function(){if(this.wrapper){this.wrapper.remove()}this.options=null;a.ligerui.remove(this)},clear:function(){var b=this,c=this.options;b.inputText.val("")},_setCss:function(b){if(b){this.wrapper.addClass(b)}},_setCancelable:function(c){var b=this,d=this.options;if(!c&&b.unselect){b.unselect.remove();b.unselect=null}if(!c&&!b.unselect){return}b.unselect=a('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide();b.wrapper.hover(function(){b.unselect.show()},function(){b.unselect.hide()});if(!d.disabled&&d.cancelable){b.wrapper.append(b.unselect)}b.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){b.clear()})},_setDisabled:function(b){if(b){this.wrapper.addClass("l-text-disabled")}else{this.wrapper.removeClass("l-text-disabled")}},_setWidth:function(c){var b=this;if(c>20){b.wrapper.css({width:c});b.inputText.css({width:c-20})}},_setHeight:function(c){var b=this;if(c>10){b.wrapper.height(c);b.inputText.height(c-2)}},_getValue:function(){return a(this.inputText).val()},getValue:function(){return this._getValue()},setValue:function(c){var b=this;b.inputText.val(c)}})})(jQuery);