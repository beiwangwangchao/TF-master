!(function(b){b.extend({isEmpty:function(c,d){return(c===null)||(c===undefined)||(!d?c==="":false)||(b.isArray(c)&&c.length===0)}});if(!window.Hap){Hap={version:"1.0",};Hap.tip=function(c){if(Hap.wintip){Hap.wintip.set("content",c);Hap.wintip.show()}else{Hap.wintip=b.ligerDialog.tip({content:c})}setTimeout(function(){Hap.wintip.hide()},2000)};Hap.showLoading=function(c){c=c||$l("sys.hand.tip.loading");b("body").append("<div class='jloading'>"+c+"</div>");b.ligerui.win.mask()};Hap.hideLoading=function(c){b("body > div.jloading").remove();b.ligerui.win.unmask({id:new Date().getTime()})};Hap.showSuccess=function(d,e,c){if(typeof(d)=="function"||arguments.length==0){e=d;d=$l("sys.hand.tip.success")}b.ligerDialog.success(d,$l("sys.hand.tip.info"),e,c)};Hap.showError=function(d,e,c){if(typeof(d)=="function"||arguments.length==0){e=d;d=$l("sys.hand.tip.failure")}b.ligerDialog.error(d,$l("sys.hand.tip.info"),e,c)};Hap.overrideGridLoading=function(){b.extend(b.ligerDefaults.Grid,{onloading:function(){Hap.showLoading($l("sys.hand.tip.loading"))},onloaded:function(){Hap.hideLoading()}})};Hap.loadForm=function(f){var g=f.form,e=f.url,d=f.para;if(!g&&!e){return}if(!(g instanceof b.ligerui.controls.Form)){g=b.ligerui.get(g)}var c=g.options.fields;b.ajax({url:e,type:f.method||"POST",dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:d,success:function(h){if(h&&h.success){var i=h.rows[0]||{};b.each(c,function(k,l){if(l.type=="date"&&i[l.name]){var j=i[l.name];if(typeof(j)=="string"&&l.options&&l.options.format){i[l.name]=j.parseDate(l.options.format)}}});g.setData(i);if(f.callback){f.callback(i,h)}}else{}},error:function(){b.ligerDialog.closeWaitting()}})};Hap.validateForm=function(c){var d=true;b.each([].concat(c),function(f,g){if(!(g instanceof b.ligerui.controls.Form)){g=b.ligerui.get(g)}var e=b(g.element);if(!e.valid()){d=false;Hap.showInvalid(e);return false}});return d};Hap.validateGrid=function(c){var d=true;b.each([].concat(c),function(e,f){if(!(f instanceof b.ligerui.controls.Grid)){f=b.ligerui.get(f)}if(f.valid instanceof Function&&!f.valid()){d=false;Hap.showInvalid(f);return false}});return d};Hap.submitForm=function(f){var i=f.form,h=f.grid?[].concat(f.grid):[],c=[].concat(f.gridName),e=f.url,j=f.wrapArray;if(!i||i.con){return}if(Hap.validateForm(i)&&Hap.validateGrid(h)){var k=i.getData();for(var g in k){if(!k[g]){delete k[g]}}if(h.length>0){b.each(h,function(l,d){d.endEdit();k[c[l]]=d.getChanges()})}i.con=b.ajax({url:e,type:"POST",dataType:"json",contentType:"application/json",data:JSON2.stringify(j===false?k:[k]),success:function(d){f.json=d;Hap.defaultSuccessHandler(f);i.con=null},error:function(){b.ligerDialog.closeWaitting();i.con=null}})}};Hap.defaultSuccessHandler=function(f){var c=f||{},e=c.json;b.ligerDialog.closeWaitting();if(e&&e.success){if(f.callback){f.callback(e)}if(c.success){c.success(e,c)}else{var d=b.ligerDialog.open({cls:"success",type:"success",content:'<div style="padding:4px">'+(c.successTip||$l("sys.hand.tip.success"))+"</div>",allowClose:false});setTimeout(function(){d.close()},1000)}}else{if(e){if(c.failure){c.failure(e,c)}}}};Hap.showInvalid=function(e){if(!e){return}if(!(e instanceof b.ligerui.controls.Form)&&!(e instanceof b.ligerui.controls.Grid)){e=b.ligerui.get(e)}var c=e.validator;if(!c){return}var d='<div class="invalid">'+c.errorList.length+$l("sys.hand.tip.invalid_field")+"</div>";b.ligerDialog.error(d)};Hap.validate=function(d,c){jQuery.metadata.setType("attr","validate");if(typeof(d)=="string"){d=b(d)}else{if(typeof(d)=="object"&&d.NodeType==1){d=b(d)}}c=b.extend({onfocusout:function(e){if(b.ligerui.get(e)&&b.ligerui.get(e).options.disabled==true){return}if(!this.checkable(e)){this.element(e)}},errorPlacement:function(e,f){b.data(e,"element",f);if(f[0]&&f[0].gridRowCell){f=b(f[0].gridRowCell).addClass("l-text-invalid")}else{if(f.hasClass("l-textarea")){f.addClass("l-textarea-invalid")}else{if(f.hasClass("l-text-field")){f.parent().addClass("l-text-invalid")}else{if(f.hasClass("l-grid-row-cell-inner")){f=f.parent().addClass("l-text-invalid")}}}}b(f).removeAttr("title").ligerHideTip();b(f).attr("title",e.html()).ligerTip({distanceX:5,distanceY:-3,auto:true})},success:function(e){element=b.data(e,"element");if(element[0]&&element[0].gridRowCell){element=b(element[0].gridRowCell).removeClass("l-text-invalid")}else{if(element.hasClass("l-textarea")){element.removeClass("l-textarea-invalid")}else{if(element.hasClass("l-text-field")){element.parent().removeClass("l-text-invalid")}else{if(element.hasClass("l-grid-row-cell-inner")){element=element.parent().removeClass("l-text-invalid")}}}}b(element).removeAttr("title").ligerHideTip()}},c||{});return d.validate(c)};Hap.createButton=function(c){var e=b.extend({appendTo:b("body")},c||{});var d=b('<div class="l-button" style="width:60px"><div class="l-button-l"> </div><div class="l-button-r"> </div> <span></span></div>');if(e.width){d.width(e.width)}if(e.click){d.click(e.click)}if(e.text){b("span",d).html(e.text)}if(typeof(e.appendTo)=="string"){e.appendTo=b(e.appendTo)}d.appendTo(e.appendTo)};Hap.addSearchButtons=function(e,d,c){if(!e){return}if(c){Hap.createButton({appendTo:c,text:$l("sys.hand.btn.query"),click:function(){var g=b(e).ligerForm().getData();for(var f in g){if(!g[f]){delete g[f]}}d.set("parms",g);d.loadData(1)}})}};Hap.setFormDefaultBtn=function(c,e){var d=[];if(c){d.push({text:$l("sys.hand.btn.cancel"),id:"form_btn_cancel",onclick:c})}if(e){d.push({text:$l("sys.hand.btn.save"),id:"form_btn_save",onclick:e})}Hap.addFormButtons(d)};Hap.addFormButtons=function(d){if(!d){return}var c=b("body > div.form-bar");if(c.length==0){c=b('<div class="form-bar"><div class="form-bar-inner"></div></div>').appendTo("body")}if(!(d instanceof Array)){d=[d]}b(d).each(function(f,g){var e=b("<div "+(g.id?('id="'+g.id+'"'):"")+' class="l-dialog-btn '+(g.disabled?"l-button-disabled":"")+'"><div class="l-dialog-btn-l"></div><div class="l-dialog-btn-r"></div><div class="l-dialog-btn-inner"></div></div> ');b("div.l-dialog-btn-inner:first",e).html(g.text||"BUTTON");if(g.onclick){e.bind("click",function(){g.onclick(g)})}if(g.width){e.width(g.width)}b("> div:first",c).append(e)})};Hap.gridQuery=function(c){var g=c.form,f=c.grid;if(!g||!f){b.ligerDialog.alert('"grid" or "form" not found in options!',$l("sys.hand.tip.info"),"error")}if(!(g instanceof b.ligerui.controls.Form)){g=b.ligerui.get(g)}var h=g.getData();for(var e in h){if(!h[e]){delete h[e]}}f.set("parms",h);f.loadData(1)};Hap.gridSave=function(c){var d=c.grid;if(!d){b.ligerDialog.alert('"grid" not found in options!',$l("sys.hand.tip.info"),"error")}if(!Hap.validateGrid(d)){return}d.endEdit();var e=d.getChanges();if(e.length==0||d.conn){return}b.ligerDialog.waitting(c.waitingTip||$l("sys.hand.tip.processing"));d.conn=b.ajax({url:c.url||"",type:"POST",dataType:"json",contentType:"application/json",data:JSON2.stringify(e),success:function(f){c=b.extend(c,{json:f,grid:d,callback:function(h){var g=b.isArray(h.rows)?h.rows:[];if(g.length>0){b.each(g,function(j,l){if(l.__status=="delete"){return true}var k=d.records[l.__id];if(k){k=b.extend(k,l,{__status:"nochanged"})}})}d.deletedRows=[];d.reRender()}});d.conn=null;Hap.defaultSuccessHandler(c)},error:function(){d.conn=null;b.ligerDialog.closeWaitting()}})};Hap.getCodeMeaning=function(e,d){for(var c in e){if(e[c].value==d){return e[c].meaning}}return""};Hap.conns={};Hap.ajax=function(c){if(Hap.conns[c.url]&&Hap.conns[c.url]==JSON2.stringify(c.data)){return}Hap.conns[c.url]=JSON2.stringify(c.data);return b.ajax({url:c.url,type:c.type||"POST",dataType:c.dataType||"json",contentType:c.contentType||"application/json",data:c.stringify==false?c.data:JSON2.stringify(c.data),opt:c,success:function(d){c=b.extend(c,{json:d});Hap.defaultSuccessHandler(c);delete Hap.conns[c.url]},error:function(){b.ligerDialog.closeWaitting();delete Hap.conns[c.url]}})};Hap.gridDelete=function(c){var d=c.grid;if(!d){b.ligerDialog.alert('"grid" not found in options!',$l("sys.hand.tip.info"),"error")}d.endEdit();var e=d.getSelectedRows(),f=[];if(e.length>0){b.ligerDialog.confirm(c.confirmTip||$l("sys.hand.tip.delete_confirm"),$l("sys.hand.tip.info"),function(h){if(h){if(c.url){var g=[];b.each(e,function(j,k){if(k.__status=="add"){g.push(k);d.remove(k)}});f=b.grep(e,function(i){var j=false;b.each(g,function(k,l){if(i.__id==l.__id){j=true;return false}});return !j});if(f.length==0){return}b.ligerDialog.waitting(c.waitingTip||$l("sys.hand.tip.processing"));b.ajax({url:c.url||"",type:"POST",dataType:"json",contentType:"application/json",data:JSON2.stringify(f),success:function(i){c=b.extend(c,{json:i,grid:d,callback:function(j){b.each(f,function(k,l){d.remove(d.records[l.__id])})}});Hap.defaultSuccessHandler(c)},error:function(){b.ligerDialog.closeWaitting()}})}else{b.each(e,function(j,k){if(k.__status=="add"){d._removeData(d.getRow(k))}});d.deleteSelectedRow()}}})}};Hap.gridSelectRenderer=function(c){return function(g,l,j,f){var h=(g.__combobox_datas&&g.__combobox_datas[f.columnname])||(f.editor&&f.editor.data),k=f.editor;if(h){for(var e=0,d=h.length;e<d;e++){if(j==h[e][k.valueField]){return h[e][k.textField]}}}else{return g[c]||""}}};Hap.gridCodeRenderer=function(g,d,e,f){var c=e;b.each(f.editor.data,function(h,j){if((j.value||"").toLowerCase()==(e||"").toLowerCase()){c=j.meaning;return false}});return c};var a=new Date().getTimezoneOffset();Hap.timeZone={getTimezoneOffset:function(){return a},set:function(f){if(!/GMT([+-]\d{4})?/.test(f)){return}if(f.length>3){var d=f.charAt(3)=="-"?-1:1;var e=+f.substring(4,6);var c=+f.substring(6);a=-d*(e*60+c)}else{a=0}}};(function(){var d={"default":"ddd MMM dd yyyy HH:mm:ss",shortDate:"M/d/yy",mediumDate:"MMM d, yyyy",longDate:"MMMM d, yyyy",fullDate:"dddd, MMMM d, yyyy",shortTime:"h:mm TT",mediumTime:"h:mm:ss TT",longTime:"h:mm:ss TT Z",isoDate:"yyyy-MM-dd",isoTime:"HH:mm:ss",isoDateTime:"yyyy-MM-dd'T'HH:mm:ss",isoUtcDateTime:"UTC:yyyy-MM-dd'T'HH:mm:ss'Z'",standard:"yyyy-MM-dd HH:mm:ss"},e=/d{1,4}|M{1,4}|yy(?:yy)?|([HhmsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,f=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,j=/[^-+\dA-Z]/g,g=function(l,k){l=String(l);k=k||2;while(l.length<k){l="0"+l}return l},i=function(k,l){return !!String(d[k]||k||d["default"]).match(l)},h=function(p,n,m){for(var q=0,k=n.match(e),l=p.match(/\d+/g),r,o=0;q<k.length;q++){if(l.length==k.length){r=l[q]}else{if(l.length==1){r=parseInt(p.slice(o,o+=k[q].length),10)}else{r=parseInt(p.slice(o=n.search(k[q]),o+k[q].length))}}switch(k[q]){case"MM":case"M":r--;break}m(k[q],r)}},c={parseDate:function(o,B,w){if(typeof o!="string"||o==""){return null}B=String(d[B]||B||d["default"]);if(B.slice(0,4)=="UTC:"){B=B.slice(4);w=true}var n=new Date(1970,1,2,0,0,0),z=w?"setUTC":"set",t=n[z+"Date"],q=n[z+"Month"],r=n[z+"FullYear"],v=n[z+"Year"],x=n[z+"Hours"],l=n[z+"Minutes"],A=n[z+"Seconds"],u=n[z+"Milliseconds"],k={d:t,dd:t,M:q,MM:q,yy:v,yyyy:r,h:x,hh:x,H:x,HH:x,m:l,mm:l,s:A,ss:A,l:u,L:u};try{h(o,B,function(m,s){k[m].call(n,s)})}catch(p){throw new SyntaxError("invalid date")}if(isNaN(n)){throw new SyntaxError("invalid date")}return n},format:function(q,B,w){if(arguments.length==1&&(typeof q=="string"||q instanceof String)&&!/\d/.test(q)){B=q;q=undefined}q=q?new Date(q):new Date();if(isNaN(q)){throw new SyntaxError("invalid date")}B=String(d[B]||B||d["default"]);if(B.slice(0,4)=="UTC:"){B=B.slice(4);w=true}var z=w?"getUTC":"get",t=q[z+"Date"](),k=q[z+"Day"](),r=q[z+"Month"](),v=q[z+"FullYear"](),x=q[z+"Hours"](),p=q[z+"Minutes"](),A=q[z+"Seconds"](),u=q[z+"Milliseconds"](),l=w?0:Hap.timeZone.getTimezoneOffset(),n={d:t,dd:g(t),M:r+1,MM:g(r+1),yy:String(v).slice(2),yyyy:v,h:x%12||12,hh:g(x%12||12),H:x,HH:g(x),m:p,mm:g(p),s:A,ss:g(A),l:g(u,3),L:g(u>99?Math.round(u/10):u),t:x<12?"a":"p",tt:x<12?"am":"pm",T:x<12?"A":"P",TT:x<12?"AM":"PM",Z:w?"UTC":(String(q).match(f)||[""]).pop().replace(j,""),o:(l>0?"-":"+")+g(Math.floor(Math.abs(l)/60)*100+Math.abs(l)%60,4),S:["th","st","nd","rd"][t%10>3?0:(t%100-t%10!=10)*t%10]};return B.replace(e,function(m){return m in n?n[m]:m.slice(1,m.length-1)})},isDateTime:function(k){return i(k,/([HhMs])\1?/)}};String.prototype.parseDate=function(k,l){return c.parseDate(this.toString(),k,l)};Date.prototype.format=function(k,l){var m=this.getTimezoneOffset()-Hap.timeZone.getTimezoneOffset();if(m==0){return c.format(this,k,l)}else{return c.format(new Date(this.getTime()+m*60000),k,l)}}})()}b(document).ajaxSuccess(function(e,f,c,d){if(d&&d.success===false){if(d.code=="session_expired"){if(top.sessionExpiredLogin){top.sessionExpiredLogin()}else{alert($l("sys.hand.tip.session_expired"));top.location.href=_basePath}}else{if(!c.opt||!c.opt.failure){b.ligerDialog.alert(d.message||"Error",$l("sys.hand.tip.info"),"error")}}}}).ajaxError(function(f,e,c,d){if(!c.error){b.ligerDialog.alert(d,""+e.status,"error")}});Date.prototype.toJSON=function(){function c(d){return d<10?"0"+d:d}return this.getFullYear()+"-"+c(this.getMonth()+1)+"-"+c(this.getDate())+" "+c(this.getHours())+":"+c(this.getMinutes())+":"+c(this.getSeconds())};b.fn.ligerForm=function(){var c=b.ligerui.run.call(this,"ligerForm",arguments);b('<input style="display: none;" type="text" />').appendTo(c.element);c.validator=Hap.validate(b(c.element));return c};b.fn.ligerGrid=function(){var c=b.ligerui.run.call(this,"ligerGrid",arguments),d=c.form=b('<form><input style="display: none;" type="text" /></form>').appendTo(c.element)[0];c.toolbar.appendTo(d);b.data(d,"validator",c.validator=Hap.validate(b(c.element)));setTimeout(function(){c._onResize()},10);return c};b.extend(b.validator.prototype,{grid:function(){this.checkGrid();b.extend(this.submitted,this.errorMap);this.invalid=b.extend({},this.errorMap);this.showErrors();return this.valid()},checkGrid:function(){this.prepareGrid();for(var d=0,e=this.currentGrid.rows,c=this.columns();e[d];d++){this.checkGridRow(e[d],c)}return this.valid()},checkGridRow:function(h,e){var f=this,d=f.currentGrid,c=d.id;b.each(e,function(g,j){var i=d.getCellObj(h,j).firstChild;i.value=b.isEmpty(h[j.columnname])?"":String(h[j.columnname]);i.name=j.columnname;i.form=d.form;i.row=h;f.check(b(i))})},columns:function(){return this.currentGrid.columns.filter(function(c){if(c.validate){return c}})},prepareGrid:function(){this.reset();this.currentGrid=liger.get(this.currentForm.id)}});b.extend(b.ligerDefaults.Grid,{root:"rows",record:"total",pageSize:10});b.extend(b.ligerDefaults.Form,{rightToken:"",labelCss:"l-label",labelAlign:"right"});b.ligerDefaults.Form.editors.html={create:function(c,f,e){if(f.field.render){var d=b(f.field.render.call(this,""));c.append(d)}return d},setValue:function(d,e,f){if(f.field.render){var c=f.field.render.call(this,e);d.parent().html(c)}},getValue:function(c,d){return""}};b.extend(b.ligerui.controls.Grid.prototype,{formatRecord:function(d,c){delete d.__previd;delete d.__nextid;delete d.__index;delete d.__combobox_datas;if(this.options.tree){delete d.__level;delete d.__hasChildren}return d},_initBuildHeader:function(){var c=this,d=this.options;if(d.title){b(".l-panel-header-text",c.header).html(d.title);if(d.headerImg){c.header.append("<img src='"+d.headerImg+"' />").addClass("l-panel-header-hasicon")}}else{c.header.hide()}if(d.toolbar){if(b.fn.ligerToolBar){c.toolbarManager=c.topbar.ligerToolBar(d.toolbar)}}else{c.topbar.remove()}},addEditRow:function(d){var c=this;d=c.add(d);return c.beginEdit(d)},getEditingRow:function(){var e=this;for(var d=0,c=e.rows.length;d<c;d++){if(e.rows[d]._editing){return e.rows[d]}}return null},valid:function(){var d=this,e=this.options,c=d.validator;if(!c){return true}return c.grid()},setEditable:function(c){this.set("enabledEdit",c);if(this.currentData){this.reRender()}}});b.extend(b.ligerui.controls.Form.prototype,{clear:function(){var c=this,e=c.options,d={};b.each(e&&e.fields,function(f,g){d[(e.prefixID||"")+g.name]=""});if(!b.isEmptyObject(d)){c.setData(d)}},reset:function(){var c=this,e=c.options,d={};b.each(e&&e.fields,function(g,h){var f=h.options;d[(e.prefixID||"")+h.name]=(f&&f.value)||""});if(!b.isEmptyObject(d)){c.setData(d)}},setEditable:function(c){this.setEnabled((this.options.fields||[]).map(function(d){return d.name}),c);b.each(this.autoEditors||[],function(d,e){e.control[c?"setEnabled":"setDisabled"]()});b.each(this.options.buttons||[],function(d,e){liger.get(e.id).set("disabled",!c)})},validField:function(c){this.validator.element(this.getEditor(c).element)}});b.extend(b.ligerui.controls.ToolBar.prototype,{setEditable:function(c){var d=this;b.each(d.options.items,function(e,f){d[c?"setEnabled":"setDisabled"](f.id)})}});b.extend(b.ligerui.controls.PopupEdit.prototype,{_initAutoComplete:function(){var c=this,d=c.options;if(!c.autoView){c.autoView=b('<div class="l-autocomplete-view"></div>').appendTo("body")}!d.autocompleteField&&b.each(d.grid.columns,function(e,f){if(f.isAutoComplete){d.autocompleteField=f.name}})},_paintAutoComplete:function(h){var f=this,c=f.autoView;if(h.total){var e=f.options.grid.columns,d=['<table cellpadding="0" cellspacing="0" width="100%"><thead class="l-grid-header"><tr class="l-grid-hd-row">'];b.each(e,function(g,i){if(i.autocompleteField){d.push('<td class="l-grid-hd-cell" style="height:28px"><div class="l-grid-hd-cell-inner" style="height:28px"><span class="l-grid-hd-cell-text">',i.display,"</span></div></td>")}});d.push('</tr></thead><tbody class="l-grid-body">');b.each(h.rows,function(g,j){d.push('<tr tabIndex="',g,'" class="l-grid-row');if(g%2==1){d.push(" l-grid-row-alt")}d.push('">');b.each(e,function(i,k){if(k.autocompleteField){d.push('<td class="l-grid-row-cell');if(i==e.length-1){d.push(" l-grid-row-cell-last")}d.push('" style="height:28px"><div class="l-grid-row-cell-inner" style="height:28px;text-align:',k.align||"center",'">',j[k.name],"</div></td>")}});d.push("</tr>")});d.push("</tbody></table>");c.html(d.join(""));if(c.width()<f.wrapper.width()){c.width(f.wrapper.width())}}else{c.html('<div style="text-align:center;line-height:26px;height:28px;width:'+f.wrapper.width()+'px">N/A</div>')}f.selectedIndex=null},setParm:function(c,d){b.ligerui.controls.Grid.prototype.setParm.call(this,c,d)},_autoCompleteQuery:function(h,k){if(b.isEmpty(h)){return}var e=this,j=e.options,i=j.grid;if(i.onLoadData){i.onLoadData.call(e)}var c=i.url;if(b.isFunction(c)){c=c.call(e)}var f=b.isFunction(i.urlParms)?i.urlParms.call(e):i.urlParms;if(f){for(name in f){c+=c.indexOf("?")==-1?"?":"&";c+=name+"="+f[name]}}var d=b.extend(j.parms||{},{pagesize:10,page:1});d[j.autocompleteField]=h;b.ajax({type:i.method||"post",url:c,data:d,dataType:"json",success:function(g){if(!g){i.data={};return}i.data=g},complete:function(){if(k){k.call(e,i.data)}else{e._paintAutoComplete(i.data);e._showAutoComplete()}},error:function(g,m,l){i.data={}}})},_showAutoComplete:function(){var i=this,e=i.options,c=e.grid,r=i.wrapper,n=i.autoView,m=r.offset(),s=r.height(),j=b(window),q=j.width(),f=j.height(),d=j.scrollTop(),t=j.scrollLeft(),k=n.width(),h=n.height(),o=m.left,l=m.top;if(o+k>q+t){o=q-k-30}if(l+s+h>f+d&&l-h>0){l-=h}else{l+=s}n.offset({left:o,top:l}).unbind("mouseover click").bind("mouseover",function(p){!b.isEmpty(i.selectedIndex)&&b(i._getNode(i.selectedIndex)).removeClass("l-grid-row-over");var g=b(p.target).parents("tr.l-grid-row");if(g.length){i.selectedIndex=Number(g.addClass("l-grid-row-over").attr("tabIndex"))}else{i.selectedIndex=null}}).bind("click",function(g){i._commitSelected()});b(document).unbind("mousedown.autocomplete").bind("mousedown.autocomplete",function(g){if(!g||(!r.find(g.target).length&&!n.find(g.target).length)){i._hideAutoComplete()}});i.autoShown=true},_hideAutoComplete:function(){var c=this;c.autoView.offset({left:-10000,top:-10000}).unbind("mouseover click");b(document).unbind("mousedown.autocomplete");c.autoShown=false},_getNode:function(e){var d=this.autoView.find("tr.l-grid-row"),c=d.length;if(e>=c){e=e%c}else{if(e<0){e=c+e%c}}return d[e]},_commitSelected:function(){var d=this;if(b.isEmpty(d.selectedIndex)){return}var i=d.options,c=i.grid,f=c.data.rows[d.selectedIndex],h={data:[f],value:f[i.valueField],text:f[i.textField]};if(d.trigger("select",h)==false){return}d.setValue(h.value);d.setText(h.text);d.trigger("selected",h);d._hideAutoComplete();d.selectedIndex=null},_selectItem:function(e,d){if(b.isEmpty(e)||e<-1){return}var h=this,f=h._getNode(e),c=h.selectedIndex;if(f&&(e=f.tabIndex)!=c){!b.isEmpty(c)&&b(h._getNode(c)).removeClass("l-grid-row-over");h.selectedIndex=e;b(f).addClass("l-grid-row-over")}},_setPopup:function(d){var c=this,e=c.options;if(d){c.link.show();if(e.cancelable){c._setCancelable(true)}}else{c.link.hide();c._setCancelable(false)}}})})(jQuery);