(function(a){a.jPanelMenu=function(b){if(typeof(b)=="undefined"||b==null){b={}}var c={options:a.extend({menu:"#menu",trigger:".menu-trigger",excludedPanelContent:"style, script",direction:"left",openPosition:"250px",animated:true,closeOnContentClick:true,keyboardShortcuts:[{code:27,open:false,close:true},{code:37,open:false,close:true},{code:39,open:true,close:true},{code:77,open:true,close:true}],duration:150,openDuration:b.duration||150,closeDuration:b.duration||150,easing:"ease-in-out",openEasing:b.easing||"ease-in-out",closeEasing:b.easing||"ease-in-out",before:function(){},beforeOpen:function(){},beforeClose:function(){},after:function(){},afterOpen:function(){},afterClose:function(){},beforeOn:function(){},afterOn:function(){},beforeOff:function(){},afterOff:function(){}},b),settings:{transitionsSupported:"WebkitTransition" in document.body.style||"MozTransition" in document.body.style||"msTransition" in document.body.style||"OTransition" in document.body.style||"Transition" in document.body.style,shiftFixedChildren:false,panelPosition:"relative",positionUnits:"px"},menu:"#jPanelMenu-menu",panel:".jPanelMenu-panel",fixedChildren:[],timeouts:{},clearTimeouts:function(){clearTimeout(c.timeouts.open);clearTimeout(c.timeouts.afterOpen);clearTimeout(c.timeouts.afterClose)},setPositionUnits:function(){var d=false,f=["%","px","em"];for(unitID in f){var e=f[unitID];if(c.options.openPosition.toString().substr(-e.length)==e){d=true;c.settings.positionUnits=e}}if(!d){c.options.openPosition=parseInt(c.options.openPosition)+c.settings.positionUnits}},checkFixedChildren:function(){c.disableTransitions();var e={position:a(c.panel).css("position")};e[c.options.direction]=(a(c.panel).css(c.options.direction)=="auto")?0:a(c.panel).css(c.options.direction);a(c.panel).find("> *").each(function(){if(a(this).css("position")=="fixed"&&a(this).css(c.options.direction)=="auto"){c.fixedChildren.push(this)}});if(c.fixedChildren.length>0){var d={position:"relative"};d[c.options.direction]="1px";c.setPanelStyle(d);if(parseInt(a(c.fixedChildren[0]).offset().left)==0){c.settings.shiftFixedChildren=true}}c.setPanelStyle(e)},setjPanelMenuStyles:function(){var f="#fff";var e=a("html").css("background-color");var d=a("body").css("background-color");if(d!="transparent"&&d!="rgba(0, 0, 0, 0)"){f=d}else{if(e!="transparent"&&e!="rgba(0, 0, 0, 0)"){f=e}else{f="#fff"}}if(a("#jPanelMenu-style-master").length==0){a("body").append('<style id="jPanelMenu-style-master">body{width:100%}.jPanelMenu,body{overflow-x:hidden}#jPanelMenu-menu{display:block;position:fixed;top:0;'+c.options.direction+":0;height:100%;z-index:-1;overflow-x:hidden;overflow-y:scroll;-webkit-overflow-scrolling:touch}.jPanelMenu-panel{position:static;"+c.options.direction+":0;top:0;z-index:2;width:100%;min-height:100%;background:"+f+"}</style>")}},setMenuState:function(e){var d=(e)?"open":"closed";a("body").attr("data-menu-position",d)},getMenuState:function(){return a("body").attr("data-menu-position")},menuIsOpen:function(){if(c.getMenuState()=="open"){return true}else{return false}},setMenuStyle:function(d){a(c.menu).css(d)},setPanelStyle:function(d){a(c.panel).css(d)},showMenu:function(){c.setMenuStyle({display:"block"});c.setMenuStyle({"z-index":"1"})},hideMenu:function(){c.setMenuStyle({"z-index":"-1"});c.setMenuStyle({display:"none"})},enableTransitions:function(e,g){var f=e/1000;var d=c.getCSSEasingFunction(g);c.disableTransitions();a("body").append('<style id="jPanelMenu-style-transitions">.jPanelMenu-panel{-webkit-transition: all '+f+"s "+d+"; -moz-transition: all "+f+"s "+d+"; -o-transition: all "+f+"s "+d+"; transition: all "+f+"s "+d+";}</style>")},disableTransitions:function(){a("#jPanelMenu-style-transitions").remove()},enableFixedTransitions:function(d,i,f,h){var g=f/1000;var e=c.getCSSEasingFunction(h);c.disableFixedTransitions(i);a("body").append('<style id="jPanelMenu-style-fixed-'+i+'">'+d+"{-webkit-transition: all "+g+"s "+e+"; -moz-transition: all "+g+"s "+e+"; -o-transition: all "+g+"s "+e+"; transition: all "+g+"s "+e+";}</style>")},disableFixedTransitions:function(d){a("#jPanelMenu-style-fixed-"+d).remove()},getCSSEasingFunction:function(d){switch(d){case"linear":return d;break;case"ease":return d;break;case"ease-in":return d;break;case"ease-out":return d;break;case"ease-in-out":return d;break;default:return"ease-in-out";break}},getJSEasingFunction:function(d){switch(d){case"linear":return d;break;default:return"swing";break}},openMenu:function(g){if(typeof(g)=="undefined"||g==null){g=c.options.animated}c.clearTimeouts();c.options.before();c.options.beforeOpen();c.setMenuState(true);c.setPanelStyle({position:"relative"});c.showMenu();var f={none:(!g)?true:false,transitions:(g&&c.settings.transitionsSupported)?true:false};if(f.transitions||f.none){if(f.none){c.disableTransitions()}if(f.transitions){c.enableTransitions(c.options.openDuration,c.options.openEasing)}var e={};e[c.options.direction]=c.options.openPosition;c.setPanelStyle(e);if(c.settings.shiftFixedChildren){a(c.fixedChildren).each(function(){var k=a(this).prop("tagName").toLowerCase()+" "+a(this).attr("class"),i=k.replace(" ","."),k=k.replace(" ","-");if(f.none){c.disableFixedTransitions(k)}if(f.transitions){c.enableFixedTransitions(i,k,c.options.openDuration,c.options.openEasing)}var j={};j[c.options.direction]=c.options.openPosition;a(this).css(j)})}c.timeouts.afterOpen=setTimeout(function(){c.disableTransitions();if(c.settings.shiftFixedChildren){a(c.fixedChildren).each(function(){var i=a(this).prop("tagName").toLowerCase()+" "+a(this).attr("class"),i=i.replace(" ","-");c.disableFixedTransitions(i)})}c.options.after();c.options.afterOpen();c.initiateContentClickListeners()},c.options.openDuration)}else{var d=c.getJSEasingFunction(c.options.openEasing);var h={};h[c.options.direction]=c.options.openPosition;a(c.panel).stop().animate(h,c.options.openDuration,d,function(){c.options.after();c.options.afterOpen();c.initiateContentClickListeners()});if(c.settings.shiftFixedChildren){a(c.fixedChildren).each(function(){var i={};i[c.options.direction]=c.options.openPosition;a(this).stop().animate(i,c.options.openDuration,d)})}}},closeMenu:function(g){if(typeof(g)=="undefined"||g==null){g=c.options.animated}c.clearTimeouts();c.options.before();c.options.beforeClose();c.setMenuState(false);var f={none:(!g)?true:false,transitions:(g&&c.settings.transitionsSupported)?true:false};if(f.transitions||f.none){if(f.none){c.disableTransitions()}if(f.transitions){c.enableTransitions(c.options.closeDuration,c.options.closeEasing)}var e={};e[c.options.direction]=0+c.settings.positionUnits;c.setPanelStyle(e);if(c.settings.shiftFixedChildren){a(c.fixedChildren).each(function(){var k=a(this).prop("tagName").toLowerCase()+" "+a(this).attr("class"),i=k.replace(" ","."),k=k.replace(" ","-");if(f.none){c.disableFixedTransitions(k)}if(f.transitions){c.enableFixedTransitions(i,k,c.options.closeDuration,c.options.closeEasing)}var j={};j[c.options.direction]=0+c.settings.positionUnits;a(this).css(j)})}c.timeouts.afterClose=setTimeout(function(){c.setPanelStyle({position:c.settings.panelPosition});c.disableTransitions();if(c.settings.shiftFixedChildren){a(c.fixedChildren).each(function(){var i=a(this).prop("tagName").toLowerCase()+" "+a(this).attr("class"),i=i.replace(" ","-");c.disableFixedTransitions(i)})}c.hideMenu();c.options.after();c.options.afterClose();c.destroyContentClickListeners()},c.options.closeDuration)}else{var d=c.getJSEasingFunction(c.options.closeEasing);var h={};h[c.options.direction]=0+c.settings.positionUnits;a(c.panel).stop().animate(h,c.options.closeDuration,d,function(){c.setPanelStyle({position:c.settings.panelPosition});c.hideMenu();c.options.after();c.options.afterClose();c.destroyContentClickListeners()});if(c.settings.shiftFixedChildren){a(c.fixedChildren).each(function(){var i={};i[c.options.direction]=0+c.settings.positionUnits;a(this).stop().animate(i,c.options.closeDuration,d)})}}},triggerMenu:function(d){if(c.menuIsOpen()){c.closeMenu(d)}else{c.openMenu(d)}},initiateClickListeners:function(){a(document).on("click",c.options.trigger,function(){c.triggerMenu(c.options.animated);return false})},destroyClickListeners:function(){a(document).off("click",c.options.trigger,null)},initiateContentClickListeners:function(){if(!c.options.closeOnContentClick){return false}a(document).on("click",c.panel,function(d){if(c.menuIsOpen()){c.closeMenu(c.options.animated)}});a(document).on("touchend",c.panel,function(d){if(c.menuIsOpen()){c.closeMenu(c.options.animated)}})},destroyContentClickListeners:function(){if(!c.options.closeOnContentClick){return false}a(document).off("click",c.panel,null);a(document).off("touchend",c.panel,null)},initiateKeyboardListeners:function(){var d=["input","textarea"];a(document).on("keydown",function(i){var h=a(i.target),f=false;a.each(d,function(){if(h.is(this.toString())){f=true}});if(f){return true}for(mapping in c.options.keyboardShortcuts){if(i.which==c.options.keyboardShortcuts[mapping].code){var g=c.options.keyboardShortcuts[mapping];if(g.open&&g.close){c.triggerMenu(c.options.animated)}else{if((g.open&&!g.close)&&!c.menuIsOpen()){c.openMenu(c.options.animated)}else{if((!g.open&&g.close)&&c.menuIsOpen()){c.closeMenu(c.options.animated)}}}return false}}})},destroyKeyboardListeners:function(){a(document).off("keydown",null)},setupMarkup:function(){a("html").addClass("jPanelMenu");a("body > *").not(c.menu+", "+c.options.excludedPanelContent).wrapAll('<div class="'+c.panel.replace(".","")+'"/>');a(c.options.menu).clone().attr("id",c.menu.replace("#","")).insertAfter("body > "+c.panel)},resetMarkup:function(){a("html").removeClass("jPanelMenu");a("body > "+c.panel+" > *").unwrap();a(c.menu).remove()},init:function(){c.options.beforeOn();c.initiateClickListeners();if(Object.prototype.toString.call(c.options.keyboardShortcuts)==="[object Array]"){c.initiateKeyboardListeners()}c.setjPanelMenuStyles();c.setMenuState(false);c.setupMarkup();c.setMenuStyle({width:c.options.openPosition});c.checkFixedChildren();c.setPositionUnits();c.closeMenu(false);c.options.afterOn()},destroy:function(){c.options.beforeOff();c.closeMenu();c.destroyClickListeners();if(Object.prototype.toString.call(c.options.keyboardShortcuts)==="[object Array]"){c.destroyKeyboardListeners()}c.resetMarkup();var d={};d[c.options.direction]="auto";a(c.fixedChildren).each(function(){a(this).css(d)});c.fixedChildren=[];c.options.afterOff()}};return{on:c.init,off:c.destroy,trigger:c.triggerMenu,open:c.openMenu,close:c.closeMenu,isOpen:c.menuIsOpen,menu:c.menu,getMenu:function(){return a(c.menu)},panel:c.panel,getPanel:function(){return a(c.panel)}}}})(jQuery);