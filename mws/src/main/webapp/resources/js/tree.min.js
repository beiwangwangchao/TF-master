(function(a){a.fn.extend({TreeView:function(c){if(a.type(c)==="object"){if(c.Default!=undefined){var b=a("<div></div>");a.each(c.Default,function(h,g){var f=a("<div></div>").addClass("nodes");var e=a("<div></div>").addClass("parentNodes");var j=a("<div></div>").addClass("childNodes").css("display","none");var l=a('<img src="image/topplus.gif"/>').addClass("plus").css({width:"9px",height:"9px",margin:"5px 4px 8px 0"});var i=a('<input type="checkbox"/>').addClass("checkbox").css("display",c.checkbox);var d=a('<span class="text"><a href="'+g.url+'">'+g.name+"</a></span>").addClass("text");e.append(l.attr("id",g.ajaxData)).append(i).append(d);f.append(e).append(j);b.append(f)});a(this).append(b.html())}else{return false}a(this).delegate(".plus","click",function(){var e=a(this).parent().next(),d=a(this);if(e.css("display")!="none"){TreeFn.childHide(d)}else{if(e.html()==""){TreeFn.GetData(d,c)}else{TreeFn.childShow(d)}}}).delegate(".checkbox","click",function(){var d=a(this),e=a(this).parent().next();if(d.attr("checked")){e.find(".checkbox").attr("checked",true)}else{e.find(".checkbox").attr("checked",false)}})}else{alert("111")}return this}})})(jQuery);var TreeFn={childShow:function(b){var a=b.parent().next();a.show();if(b.attr("src").indexOf("top")>=0){b.attr("src","image/topminus.gif")}else{if(b.attr("src").indexOf("end")>=0){b.attr("src","image/endminus.gif")}else{b.attr("src","image/centerminus.gif")}}},childHide:function(b){var a=b.parent().next();a.hide();if(b.attr("src").indexOf("top")>=0){b.attr("src","image/topplus.gif")}else{if(b.attr("src").indexOf("end")>=0){b.attr("src","image/endplus.gif")}else{b.attr("src","image/centerplus.gif")}}},lineImage:function(b){var a=$("<div></div>");var c=b.parent().children();c.each(function(e){if(e<c.size()-3){var d=$('<img src="image/line.gif"/>').addClass("line");var f=$('<img src="image/null.gif"/>').addClass("null");if($(this).attr("class")=="line"||$(this).attr("class")=="join"||$(this).attr("src").indexOf("center")>=0){a.append(d)}else{a.append(f)}}});return a},AnalyJSON:function(b,d,c){var a=$("<div></div>");$.each(b,function(p,o){var e=$("<div></div>").addClass("nodes");var q=$("<div></div>").addClass("parentNodes");var r=$("<div></div>").addClass("childNodes").css("display","none");var s=$('<img src="image/line.gif"/>').addClass("line");var n=$('<img src="image/topplus.gif.gif" />').addClass("plus");var g=$('<img src="image/centerplus.gif" />').addClass("plus").attr("id",o.id);var k=$('<img src="image/endplus.gif"/>').addClass("plus").attr("id",o.id);var f=$('<img src="image/join.gif"/>').addClass("join");var j=$('<img src="image/lineh.gif"/>').addClass("end");var i=$('<img src="image/end.gif"/>').addClass("end");var l=$('<input type="checkbox"/>').addClass("checkbox").css("display",c.checkbox);var m=$('<span class="text"><a href="'+o.url+'">'+o.name+"</a></span>").addClass("text");var h=TreeFn.lineImage(d);if(o.hasChild=="1"){if(o.last==undefined||o.last!="1"){q.append(h.html()).append(f).append(g);if(d.next().attr("checked")){q.append(l.attr("checked",true)).append(m)}else{q.append(l).append(m)}}else{q.append(h.html()).append(i).append(k);if(d.next().attr("checked")){q.append(l.attr("checked",true)).append(m)}else{q.append(l).append(m)}}e.append(q);e.append(r);a.append(e)}else{if(o.last==undefined||o.last!="1"){q.append(h.html()).append(f).append(j);if(d.next().attr("checked")){q.append(l.attr("checked",true)).append(m)}else{q.append(l).append(m)}}else{q.append(h.html()).append(i).append(j);if(d.next().attr("checked")){q.append(l.attr("checked",true)).append(m)}else{q.append(l).append(m)}}e.append(q);e.append(r);a.append(e)}});return a},GetData:function(b,a){$.ajax({type:"GET",cache:false,async:false,url:a.ajaxUrl,dataType:"text",data:{Key:b.attr("id")},beforeSend:function(){b.parent().append('<img src="image/Loading.gif" class="load"/>')},success:function(c){b.parent().next().html("").append(TreeFn.AnalyJSON($.parseJSON(c),b,a).html());TreeFn.childShow(b)},complete:function(){b.parent().children().remove(".load")}})}};