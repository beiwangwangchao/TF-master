function exportSelected(h,l,g,k){var j=liger.get(l);var d=new Array();var c={};var f={};var b={};var i=0;for(var e in j.options.columns){if(!j.options.columns[e]._hide){if(j.options.columns[e]._hide==false){if(j.options.columns[e].textField){d[i]=j.options.columns[e].textField;c[j.options.columns[e].textField]=j.options.columns[e].display}else{d[i]=j.options.columns[e].columnname;c[j.options.columns[e].columnname]=j.options.columns[e].display}i++}}}$.each(g,function(n,m){for(var o in m){b[m[o].value]=m[o].meaning}f[n]=b;b={}});$("#"+l).after("<form id='exportForm' method='POST' target='_blank'><input id='exportContent' name='exportContent' style='visibility:hidden'/><input id='exportIndex' name='exportIndex' style='visibility:hidden'/><input id='exportListData' name='exportListData' style='visibility:hidden'/><input id='exportHeader' name='exportHeader' style='visibility:hidden'/></form>");var a=k+"/export/excel";$("#exportContent").val(JSON.stringify(j.getCheckedRows()));$("#exportIndex").val(JSON.stringify(d));$("#exportHeader").val(JSON.stringify(c));$("#exportListData").val(JSON.stringify(f));$("#exportForm").attr("action",a).submit();$("#exportForm").remove()}function exportAll(b,d,e,g){var f=window[b].getData();for(var c in f){if(!f[c]){delete f[c]}}f.page=1;f.pagesize=10000;var a=liger.get(d);if(a){$.ajax({type:"POST",url:a.options.url,data:f,dataType:"json",success:function(o){if(o.success){var m=new Array();var j={};var n={};var i={};var l=0;for(var h in a.options.columns){if(!a.options.columns[h]._hide){if(a.options.columns[h]._hide==false){if(a.options.columns[h].textField){m[l]=a.options.columns[h].textField;j[a.options.columns[h].textField]=a.options.columns[h].display}else{m[l]=a.options.columns[h].columnname;j[a.options.columns[h].columnname]=a.options.columns[h].display}l++}}}$.each(e,function(q,p){for(var r in p){i[p[r].value]=p[r].meaning}n[q]=i;i={}});$("#"+d).after("<form id='exportForm' method='POST' target='_blank'><input id='exportContent' name='exportContent' style='visibility:hidden'/><input id='exportIndex' name='exportIndex' style='visibility:hidden'/><input id='exportListData' name='exportListData' style='visibility:hidden'/><input id='exportHeader' name='exportHeader' style='visibility:hidden'/></form>");var k=g+"/export/excel";$("#exportContent").val(JSON.stringify(o.rows));$("#exportIndex").val(JSON.stringify(m));$("#exportHeader").val(JSON.stringify(j));$("#exportListData").val(JSON.stringify(n));$("#exportForm").attr("action",k).submit();$("#exportForm").remove()}}});delete f.page;delete f.pagesize}}function exportDirectAll(j,o,i,n){var d=window[j].getData();var g="";for(var l in d){if(!d[l]){delete d[l]}else{g=g+l+"="+d[l]+"&"}}g=g+"page=1&pagesize=10000";var m=liger.get(o);if(m){var e=new Array();var c={};var h={};var b={};var k=0;for(var f in m.options.columns){if(!m.options.columns[f]._hide){if(m.options.columns[f]._hide==false){if(m.options.columns[f].textField){e[k]=m.options.columns[f].textField;c[m.options.columns[f].textField]=m.options.columns[f].display}else{e[k]=m.options.columns[f].columnname;c[m.options.columns[f].columnname]=m.options.columns[f].display}k++}}}$.each(i,function(q,p){for(var r in p){b[p[r].value]=p[r].meaning}h[q]=b;b={}});$("#"+o).after("<form id='exportForm' method='POST' target='_blank'><input id='exportIndex' name='exportIndex' style='visibility:hidden'/><input id='isExport2Excel' name='isExport2Excel' style='visibility:hidden'/><input id='exportListData' name='exportListData' style='visibility:hidden'/><input id='exportHeader' name='exportHeader' style='visibility:hidden'/></form>");var a=m.options.url+"?"+g;$("#exportIndex").val(JSON.stringify(e));$("#exportHeader").val(JSON.stringify(c));$("#exportListData").val(JSON.stringify(h));$("#isExport2Excel").val("Y");$("#exportForm").attr("action",a).submit();$("#exportForm").remove()}};